# Visual Studio Code 重複行を削除する

## 手順

### 1. 行をソートする

- `Ctrl` + `A` でソートする行を範囲選択する
- `Ctrl` + `Shift` + `P`
- `>Sort Lines Ascending` 昇順または降順に並び替える(悩んだら昇順)

### 2. 正規表現で重複行を削除する

- 検索窓を表示する: `Ctrl` + `F`
- 正規表現を使用する: `Alt` + `R`
- 検索ボックスへ入力: `(^.*$)(\n(^\1$)){1,}`
- 置換ボックスへ入力: `$1`
- すべて置換: `Ctrl` + `Alt` + `Enter`

## 説明

「`(^.*$)\n(^\1$){1,}`」という正規表現で「改行コードで区切られた、同じ文字列の連続した行を複数マッチさせるパターン」です。これは、最初の行にマッチした文字列を後続の行で同じ文字列が連続している場合に、その連続する行全体を抽出するための表現です。

### 正規表現の分解

`(^.*$)`:この全体で「1 行の任意の文字列」にマッチします。この部分は、後で参照するためのグループ`\1`として使われます。

- `^`: 行の先頭にマッチします。
- `.`: 任意の文字にマッチします（改行文字を除く）。
- `*`: 直前の文字（この場合は`.`）が 0 回以上繰り返されることにマッチします。
- `$`: 行の末尾にマッチします。

`\n`:改行コードにマッチします。

`(^\1$)`:この全体で、「最初の行と同じ文字列で構成される 1 行」にマッチします。

- `^`: 行の先頭にマッチします。
- `\1`: 最初のグループ`(^.*$)`でキャプチャされた文字列（＝最初の行の文字列）にマッチします。
- `$`: 行の末尾にマッチします。

`{1,}`:直前のグループ (`^\1$`) が 1 回以上繰り返されることにマッチします。

### 具体例

以下のテキストをこのパターンで置換した場合を考えます。
対象テキスト

```
apple
apple
apple
banana
banana
```

操作
`(^.*$)` が apple をキャプチャします（これが `$1` になります）。
`\n(^\1$)){1,}` が、それに続く 2 つの apple に一致します。
この一致した部分全体（最初の apple と、それに続く 2 つの apple）が、`$1` の apple で置き換えられます。
次に banana のグループに対して同様の操作が行われ、banana で置き換えられます。
結果

```
apple
banana
```

このように、連続して同じ文字列が続く場合に、2 行目以降の同じ文字列を削除し、先頭の文字列だけを残すことができます。
